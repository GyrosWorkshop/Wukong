FROM microsoft/dotnet:1.1.1-sdk
WORKDIR /dotnetapp

RUN mkdir -p /dotnetapp
COPY Wukong.sln /dotnetapp/
COPY WukongNew /dotnetapp/WukongNew/
RUN dotnet restore
# Publish to /dotnetapp/dist
RUN dotnet publish -c Release -o ../dist -r debian.8-x64

COPY appsettings.template.json /dotnetapp/

COPY start.sh /
RUN chmod +x /start.sh

EXPOSE 5000
CMD ["/start.sh"]
